function toggleDebugFlag(){logDebugMessage("[Debug] Toggle DEBUG flag");let e="debug-flag-store",g=indexedDB.open("sainternet-db");g.onerror=e=>logDebugMessage("[Debug] Error opening database","error"),g.onupgradeneeded=g=>{let r=g.target.result,t=r.createObjectStore(e,{keyPath:"id"});t.put({id:1,value:!1})},g.onsuccess=g=>{let r=g.target.result,t=r.transaction(e,"readwrite"),o=t.objectStore(e),a=o.get(1);a.onerror=e=>logDebugMessage("[Debug] Error retrieving DEBUG flag","error"),a.onsuccess=e=>{let g=a.result.value,r=!g;o.put({id:1,value:r}),navigator.serviceWorker.controller.postMessage({type:"setDebugFlag",value:r}),logDebugMessage("[Debug] Toggle DEBUG flag")}}}function logDebugMessage(e,g="log"){let r=indexedDB.open("debugFlagDB"),t=!1;r.onerror=function(e){logDebugMessage("[Debug] Error opening database","error")},r.onsuccess=function(r){let o=r.target.result,a=o.transaction(["debugFlag"],"readonly"),u=a.objectStore("debugFlag"),l=u.get("debugFlag");l.onerror=function(e){logDebugMessage("[Debug] Error getting DEBUG flag value","error")},l.onsuccess=function(r){l.result&&(t=l.result.value),t&&console[g](e)}},r.onupgradeneeded=function(e){let g=e.target.result,r=g.createObjectStore("debugFlag",{keyPath:"name"});r.add({name:"debugFlag",value:!1})}}
